(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7325],{8376:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(40157).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},28214:(e,t,r)=>{"use strict";r.d(t,{IG:()=>p,db:()=>f,j2:()=>m,rm:()=>h});var n=r(23915),s=r(93004),o=r(35317),i=r(81427),a=r(90858),l=r(86864),c=r(49509);let d={apiKey:"AIzaSyDZoznRXygrNINbo60NI6oidbcxd1vQSlY",authDomain:"amplifydmvp.firebaseapp.com",projectId:"amplifydmvp",storageBucket:"amplifydmvp.appspot.com",messagingSenderId:"486875334710",appId:"1:486875334710:web:aa477f4f137cac9d3f7097",measurementId:"G-RJJ6V0LHFK"};if(!(d.apiKey&&d.authDomain&&d.projectId&&d.storageBucket&&d.messagingSenderId&&d.appId))throw Error("Missing Firebase environment variables. Please check your .env.local file.");let u=(0,n.Dk)().length?(0,n.Sx)():(0,n.Wp)(d),m=(0,s.xI)(u),f=(0,o.aU)(u),p=(0,a.c7)(u);(0,l.TT)().then(e=>e?(0,l.P5)(u):null);let g=null;if(c.env.NEXT_PUBLIC_FIREBASE_AUTH_EMULATOR_HOST&&((0,s.Wq)(m,"http://".concat(c.env.NEXT_PUBLIC_FIREBASE_AUTH_EMULATOR_HOST)),console.log("Connected to Auth Emulator: http://".concat(c.env.NEXT_PUBLIC_FIREBASE_AUTH_EMULATOR_HOST))),c.env.NEXT_PUBLIC_FIREBASE_FIRESTORE_EMULATOR_HOST){let[e,t]=c.env.NEXT_PUBLIC_FIREBASE_FIRESTORE_EMULATOR_HOST.split(":");(0,o.vN)(f,e,parseInt(t)),console.log("Connected to Firestore Emulator: http://".concat(e,":").concat(t))}if(c.env.NEXT_PUBLIC_FIREBASE_STORAGE_EMULATOR_HOST){let[e,t]=c.env.NEXT_PUBLIC_FIREBASE_STORAGE_EMULATOR_HOST.split(":");(0,a.nb)(p,e,parseInt(t)),console.log("Connected to Storage Emulator: http://".concat(c.env.NEXT_PUBLIC_FIREBASE_STORAGE_EMULATOR_HOST))}if(g=(0,i.Uz)(u),c.env.NEXT_PUBLIC_FIREBASE_FUNCTIONS_EMULATOR_HOST){let[e,t]=c.env.NEXT_PUBLIC_FIREBASE_FUNCTIONS_EMULATOR_HOST.split(":");(0,i.f5)(g,e,parseInt(t)),console.log("Connected to Functions Emulator: http://".concat(e,":").concat(t))}function h(){if(!g&&(g=(0,i.Uz)(u),c.env.NEXT_PUBLIC_FIREBASE_FUNCTIONS_EMULATOR_HOST)){let[e,t]=c.env.NEXT_PUBLIC_FIREBASE_FUNCTIONS_EMULATOR_HOST.split(":");(0,i.f5)(g,e,parseInt(t)),console.log("Connected to Functions Emulator: http://".concat(e,":").concat(t))}return g}},30179:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var n=r(95155),s=r(12115),o=r(59576),i=r(97326),a=r(66695),l=r(50172),c=r(98921),d=r(37648),u=r(8376),m=r(6874),f=r.n(m),p=r(30285);function g(){let{currentUser:e,loading:t}=(0,o.A)(),[r,m]=(0,s.useState)([]),[g,h]=(0,s.useState)(!0),[v,y]=(0,s.useState)(null);return((0,s.useEffect)(()=>{async function r(){if(!e||"reviewer"!==e.role)return void h(!1);try{let t=await (0,i.Oq)({reviewerId:e.id});m(t)}catch(e){console.error("Error fetching submissions:",e),y("Failed to load submissions.")}finally{h(!1)}}t||r()},[e,t]),t||g)?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,n.jsx)(l.A,{className:"w-8 h-8 animate-spin text-primary"})}):e&&"reviewer"===e.role?(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold font-headline",children:"Reviewer Dashboard"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Manage your assigned music submissions."})]}),v&&(0,n.jsx)("div",{className:"text-center py-4 text-destructive",children:(0,n.jsx)("p",{children:v})}),0===r.length?(0,n.jsxs)("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[(0,n.jsx)(c.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,n.jsx)("h3",{className:"mt-2 text-lg font-medium",children:"No Submissions Assigned"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"You currently have no music submissions to review."})]}):(0,n.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:r.map(e=>(0,n.jsxs)(a.Zp,{children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{children:e.songTitle}),(0,n.jsxs)(a.BT,{children:["by ",e.artistName]})]}),(0,n.jsxs)(a.Wu,{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:["pending"===e.status?(0,n.jsx)(d.A,{className:"w-4 h-4"}):(0,n.jsx)(u.A,{className:"w-4 h-4 text-green-500"}),(0,n.jsxs)("span",{children:["Status: ",e.status]})]}),(0,n.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Genre: ",e.genre]}),(0,n.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Submitted: ",new Date(e.submittedAt).toLocaleDateString()]}),(0,n.jsx)(p.$,{asChild:!0,className:"w-full mt-4",children:(0,n.jsx)(f(),{href:"/dashboard/reviewer/".concat(e.id),children:"Review Submission"})})]})]},e.id))})]}):(0,n.jsxs)("div",{className:"text-center py-20",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Access Denied"}),(0,n.jsxs)("p",{className:"text-muted-foreground",children:["You must be a reviewer to access this dashboard.",(0,n.jsx)("br",{}),"Current user: ",e?JSON.stringify(e):"null",(0,n.jsx)("br",{}),"Role: ",null==e?void 0:e.role]}),(0,n.jsx)(p.$,{asChild:!0,className:"mt-4",children:(0,n.jsx)(f(),{href:"/login",children:"Log In as Reviewer"})})]})}},30285:(e,t,r)=>{"use strict";r.d(t,{$:()=>c,r:()=>l});var n=r(95155),s=r(12115),o=r(66634),i=r(74466),a=r(59434);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:c=!1,...d}=e,u=c?o.DX:"button";return(0,n.jsx)(u,{className:(0,a.cn)(l({variant:s,size:i,className:r})),ref:t,...d})});c.displayName="Button"},37648:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(40157).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},45011:(e,t,r)=>{"use strict";r.d(t,{Kg:()=>l,lo:()=>i,pD:()=>a});var n=r(35317),s=r(81427),o=r(28214);async function i(){return console.log("Fetching users from Firestore..."),(await (0,n.GG)((0,n.P)((0,n.rJ)(o.db,"users"),(0,n.My)("joinedAt","desc")))).docs.map(e=>({id:e.id,...e.data()}))}async function a(){if(console.log("[getCurrentUserInfo] Getting current user info..."),!o.j2.currentUser)return console.log("[getCurrentUserInfo] No authenticated user."),null;console.log("[getCurrentUserInfo] Authenticated user UID: ".concat(o.j2.currentUser.uid));let e=(0,n.H9)(o.db,"users",o.j2.currentUser.uid),t=await (0,n.x7)(e);if(!t.exists())return console.log("[getCurrentUserInfo] No user document found for UID: ".concat(o.j2.currentUser.uid)),null;let r={id:t.id,...t.data()};return console.log("[getCurrentUserInfo] User document found:",r),r}async function l(e){console.log("Invoking 'approveApplication' cloud function for application: ".concat(e));try{let t=(0,s.Uz)(),r=(0,s.Qg)(t,"approveApplication"),n=await r({applicationId:e});return console.log("âœ… Application approved successfully.",n.data),n.data}catch(t){console.error("Error calling 'approveApplication' cloud function:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to approve application: ".concat(e))}}},50172:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(40157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},54291:(e,t,r)=>{Promise.resolve().then(r.bind(r,30179))},59434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var n=r(52596),s=r(39688);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,n.$)(t))}},59576:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,AuthProvider:()=>d});var n=r(95155),s=r(12115),o=r(93004),i=r(28214),a=r(45011),l=r(50172);let c=(0,s.createContext)(void 0),d=e=>{let{children:t}=e,[r,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(null),[f,p]=(0,s.useState)(!0),[g,h]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=(0,o.hg)(i.j2,async e=>{if(m(e),e)try{let e=await (0,a.pD)();console.log("User info in AuthContext:",e),d(e),h(null)}catch(t){console.error("Error fetching user info from Firestore:",t);let e="Failed to load user profile.";t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),h(e),d(null)}else d(null),h(null);p(!1)});return()=>e()},[]);let v=(null==r?void 0:r.role)==="admin",y=(null==r?void 0:r.role)==="reviewer",x=(null==r?void 0:r.role)==="uploader";return f?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsx)(l.A,{className:"w-10 h-10 animate-spin text-primary"})}):(0,n.jsx)(c.Provider,{value:{currentUser:r,loading:f,error:g,firebaseUser:u,isAdmin:v,isReviewer:y,isUploader:x},children:t})},u=()=>{let e=(0,s.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},66634:(e,t,r)=>{"use strict";r.d(t,{DX:()=>a,TL:()=>i});var n=r(12115);function s(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var o=r(95155);function i(e){let t=function(e){let t=n.forwardRef((e,t)=>{let{children:r,...o}=e;if(n.isValidElement(r)){var i;let e,a,l=(i=r,(a=(e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.ref:(a=(e=Object.getOwnPropertyDescriptor(i,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.props.ref:i.props.ref||i.ref),c=function(e,t){let r={...t};for(let n in t){let s=e[n],o=t[n];/^on[A-Z]/.test(n)?s&&o?r[n]=(...e)=>{let t=o(...e);return s(...e),t}:s&&(r[n]=s):"style"===n?r[n]={...s,...o}:"className"===n&&(r[n]=[s,o].filter(Boolean).join(" "))}return{...e,...r}}(o,r.props);return r.type!==n.Fragment&&(c.ref=t?function(...e){return t=>{let r=!1,n=e.map(e=>{let n=s(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():s(e[t],null)}}}}(t,l):l),n.cloneElement(r,c)}return n.Children.count(r)>1?n.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=n.forwardRef((e,r)=>{let{children:s,...i}=e,a=n.Children.toArray(s),l=a.find(c);if(l){let e=l.props.children,s=a.map(t=>t!==l?t:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,o.jsx)(t,{...i,ref:r,children:n.isValidElement(e)?n.cloneElement(e,void 0,s):null})}return(0,o.jsx)(t,{...i,ref:r,children:s})});return r.displayName=`${e}.Slot`,r}var a=i("Slot"),l=Symbol("radix.slottable");function c(e){return n.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===l}},66695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>i,aR:()=>a,wL:()=>u});var n=r(95155),s=r(12115),o=r(59434);let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});i.displayName="Card";let a=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...s})});a.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});l.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},74466:(e,t,r)=>{"use strict";r.d(t,{F:()=>i});var n=r(52596);let s=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,o=n.$,i=(e,t)=>r=>{var n;if((null==t?void 0:t.variants)==null)return o(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:i,defaultVariants:a}=t,l=Object.keys(i).map(e=>{let t=null==r?void 0:r[e],n=null==a?void 0:a[e];if(null===t)return null;let o=s(t)||s(n);return i[e][o]}),c=r&&Object.entries(r).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return o(e,l,null==t||null==(n=t.compoundVariants)?void 0:n.reduce((e,t)=>{let{class:r,className:n,...s}=t;return Object.entries(s).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...a,...c}[t]):({...a,...c})[t]===r})?[...e,r,n]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}},97326:(e,t,r)=>{"use strict";r.d(t,{C5:()=>d,Ib:()=>i,Oq:()=>a,hx:()=>l,pQ:()=>c,qT:()=>u,se:()=>m});var n=r(81427),s=r(28214),o=r(35317);async function i(e){console.log("Uploading file to Firebase Storage...");try{let t=(0,n.Uz)(),r=(0,n.Qg)(t,"getSignedUploadUrl"),{data:s}=await r({fileName:e.name,contentType:e.type});if(!s||!s.url||!s.filePath)throw Error("Failed to get signed upload URL.");if(!(await fetch(s.url,{method:"PUT",headers:{"Content-Type":e.type,"x-goog-meta-signed-url":"true"},body:e})).ok)throw Error("Failed to upload file using signed URL.");let o="https://firebasestorage.googleapis.com/v0/b/".concat("amplifydmvp.appspot.com","/o/").concat(encodeURIComponent(s.filePath),"?alt=media");return console.log("File uploaded successfully. Download URL:",o),o}catch(t){console.error("Error in uploadMusicFile:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to upload music file: ".concat(e))}}async function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("Fetching submissions from Firestore (all: ".concat(!!e.all,", reviewerId: ").concat(e.reviewerId||"none",", artistId: ").concat(e.artistId||"none",")..."));let t=(0,o.rJ)(s.db,"submissions"),r=(0,o.P)(t,(0,o.My)("submittedAt","desc"));return e.reviewerId?r=(0,o.P)(r,(0,o._M)("reviewerId","==",e.reviewerId)):e.artistId?r=(0,o.P)(r,(0,o._M)("artistId","==",e.artistId)):e.all||(r=(0,o.P)(r,(0,o._M)("status","==","Pending Review"))),(await (0,o.GG)(r)).docs.map(e=>({id:e.id,...e.data()}))}async function l(e){console.log("Fetching submission ".concat(e," from Firestore..."));let t=(0,o.H9)(s.db,"submissions",e),r=await (0,o.x7)(t);return r.exists()?{id:r.id,...r.data()}:(console.log("No such document!"),null)}async function c(e){let t=(0,s.rm)(),r=(0,n.Qg)(t,"getSubmissionStatusByToken");try{return(await r(e)).data}catch(t){console.error("Error calling getSubmissionStatusByToken Cloud Function:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to get submission status: ".concat(e))}}async function d(){console.log("Fetching all submissions for admin from Firestore...");let e=(0,o.rJ)(s.db,"submissions"),t=(0,o.P)(e,(0,o.My)("submittedAt","desc"));return(await (0,o.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}async function u(e,t){console.log("Updating submission ".concat(e," status to ").concat(t));let r=(0,o.H9)(s.db,"submissions",e);try{await (0,o.mZ)(r,{status:t})}catch(t){console.error("Error updating submission status:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to update submission status: ".concat(e))}}async function m(e,t){console.log("Assigning reviewer ".concat(t," to submission ").concat(e));let r=(0,o.H9)(s.db,"submissions",e);try{await (0,o.mZ)(r,{reviewerId:t})}catch(t){console.error("Error assigning reviewer to submission:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to assign reviewer to submission: ".concat(e))}}},98921:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(40157).A)("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,3644,4277,555,6874,8441,1684,7358],()=>t(54291)),_N_E=e.O()}]);