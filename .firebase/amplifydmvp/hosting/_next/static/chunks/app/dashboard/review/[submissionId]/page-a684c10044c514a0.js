(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3240],{17313:(e,s,a)=>{"use strict";a.d(s,{Xi:()=>c,av:()=>o,j7:()=>n,tU:()=>d});var t=a(95155),i=a(12115),l=a(60704),r=a(59434);let d=l.bL,n=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(l.B8,{ref:s,className:(0,r.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...i})});n.displayName=l.B8.displayName;let c=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(l.l9,{ref:s,className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...i})});c.displayName=l.l9.displayName;let o=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(l.UC,{ref:s,className:(0,r.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...i})});o.displayName=l.UC.displayName},49762:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>U});var t=a(95155),i=a(90221),l=a(62177),r=a(9521),d=a(30285),n=a(66695),c=a(82320),o=a(68856),u=a(36338),m=a(8553),x=a(50172),h=a(59119),f=a(73672),j=a(12115),p=a(17759),b=a(87481),v=a(35695),N=a(8731),g=a(28214),w=a(6874),y=a.n(w),k=a(33598),R=a(57599),E=a(17313),S=a(90010);function F(){return(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsx)(o.E,{className:"h-8 w-3/4"}),(0,t.jsx)(o.E,{className:"h-4 w-1/4"})]}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)(o.E,{className:"h-40 w-full"})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsx)(o.E,{className:"h-7 w-1/3"}),(0,t.jsx)(o.E,{className:"h-4 w-2/3"})]}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)(o.E,{className:"h-64 w-full"})})]})]}),(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(o.E,{className:"h-7 w-1/2"})}),(0,t.jsxs)(n.Wu,{className:"space-y-4",children:[(0,t.jsx)(o.E,{className:"h-10 w-full"}),(0,t.jsx)(o.E,{className:"h-4 w-full"}),(0,t.jsx)(o.E,{className:"h-10 w-full"}),(0,t.jsx)(o.E,{className:"h-10 w-full"})]})]})})]})}function U(e){let{params:s}=e,a=(0,j.use)(s),[o,w]=(0,N.hD)(g.j2),[U,A]=(0,j.useState)(void 0),[C,Z]=(0,j.useState)(!1),[V,D]=(0,j.useState)(!1),[_,O]=(0,j.useState)(!1),[T,Y]=(0,j.useState)(!1),[B,L]=(0,j.useState)(!1),{toast:W}=(0,b.dj)(),$=(0,v.useRouter)(),q=(0,l.mN)({resolver:(0,i.u)(r.Y),defaultValues:{originality:5,structure:5,melody:5,lyrics:5,vocal_performance:5,instrumental_performance:5,energy:5,technical_skill:5,sound_quality:5,mixing:5,sound_design:5,mastering:5,commercial_potential:5,target_audience:5,branding:5,uniqueness:5,strengths:"",improvements:"",overallReview:"",audioFeedbackUrl:"",videoFeedbackUrl:"",isDraft:!1}}),z=q.watch(),X=(0,j.useMemo)(()=>{let e=Object.keys(z).filter(e=>"number"==typeof z[e]).map(e=>z[e]);return 0===e.length?0:e.reduce((e,s)=>e+s,0)/e.length},[z]);(0,j.useEffect)(()=>{!w&&o&&(async()=>{A(void 0);let e=await (0,c.hx)(a.submissionId);A(e),e&&Z(await (0,c.LH)(e.id,o.uid))})()},[a.submissionId,o,w]);let H=async()=>{if(U){O(!0);try{let e=q.getValues();e.isDraft=!0,await (0,c.h6)(U,e,X),W({title:"Draft Saved",description:"Your review has been saved as a draft."})}catch(e){W({title:"Draft Saved",description:e instanceof Error?e.message:"Failed to save draft."})}finally{O(!1)}}},I=async()=>{L(!1);let e=q.getValues();await J(e)},J=async e=>{if(!U)return void W({title:"Submission Not Found",description:"Cannot submit review for a non-existent submission.",variant:"destructive"});D(!0);try{e.isDraft=!1;let{reviewId:s,reviewUrl:a}=await (0,c.h6)(U,e,X);W({title:"Review Submitted!",description:"Your feedback has been published. The artist will receive a link to view their review."}),console.log("Review completed! Artist can view at: ".concat(a)),$.push("/dashboard/submissions")}catch(e){W({title:"Submission Failed",description:e instanceof Error?e.message:"There was an error submitting the review.",variant:"destructive"})}finally{D(!1)}};return void 0===U?(0,t.jsx)(F,{}):null===U?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center py-20",children:[(0,t.jsx)(u.A,{className:"w-16 h-16 text-destructive mb-4"}),(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Submission Not Found"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"The submission you are looking for does not exist or has been removed."})]}):C?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center py-20",children:[(0,t.jsx)(u.A,{className:"w-16 h-16 text-yellow-500 mb-4"}),(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Review Already Submitted"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"You have already submitted a review for this submission. Only one review per submission is allowed."}),(0,t.jsx)(d.$,{asChild:!0,className:"mt-4",variant:"outline",children:(0,t.jsx)(y(),{href:"/dashboard/submissions",children:"Back to Submissions"})})]}):(0,t.jsxs)(p.lV,{...q,children:[(0,t.jsxs)("form",{onSubmit:q.handleSubmit(e=>Y(!0)),className:"grid md:grid-cols-3 gap-8 items-start",children:[(0,t.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsxs)(n.ZB,{className:"text-2xl font-bold font-headline break-words",title:"Reviewing: &quot;".concat(U.songTitle,"&quot;"),children:['Reviewing: "',U.songTitle,'"']}),(0,t.jsxs)(n.BT,{className:"break-words",title:"by ".concat(U.artistName),children:["by ",U.artistName]})]}),(0,t.jsx)(n.Wu,{children:U.audioUrl?(0,t.jsxs)("div",{className:"bg-muted rounded-lg p-4 flex flex-col items-center gap-4",children:[(0,t.jsx)(m.A,{className:"w-16 h-16 text-muted-foreground"}),(0,t.jsxs)("audio",{controls:!0,className:"w-full",children:[(0,t.jsx)("source",{src:U.audioUrl,type:"audio/mpeg"}),"Your browser does not support the audio element."]})]}):(0,t.jsxs)("div",{className:"bg-muted rounded-lg p-4 flex flex-col items-center gap-4 text-center",children:[(0,t.jsx)(m.A,{className:"w-16 h-16 text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No audio file available for this submission."})]})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsx)(n.ZB,{children:"Your Feedback"}),(0,t.jsx)(n.BT,{children:"Use the sliders and text areas below to provide detailed feedback."})]}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)(r.A,{form:q,scores:z})})]}),(0,t.jsxs)(E.tU,{defaultValue:"audio",className:"w-full",children:[(0,t.jsxs)(E.j7,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(E.Xi,{value:"audio",children:"Audio Feedback"}),(0,t.jsx)(E.Xi,{value:"video",children:"Video Feedback"})]}),(0,t.jsx)(E.av,{value:"audio",className:"space-y-4",children:(0,t.jsx)(k.A,{onRecordingComplete:e=>{q.setValue("audioFeedbackUrl",e)},onRecordingDelete:()=>{q.setValue("audioFeedbackUrl","")},existingAudioUrl:q.watch("audioFeedbackUrl")})}),(0,t.jsx)(E.av,{value:"video",className:"space-y-4",children:(0,t.jsx)(R.A,{onRecordingComplete:e=>{q.setValue("videoFeedbackUrl",e)},onRecordingDelete:()=>{q.setValue("videoFeedbackUrl","")},existingVideoUrl:q.watch("videoFeedbackUrl")})})]})]}),(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"Review Summary"})}),(0,t.jsxs)(n.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Overall Score"}),(0,t.jsxs)("span",{className:"text-2xl font-bold text-primary",children:[X.toFixed(1),"/10"]})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"The overall score is calculated automatically as you complete the scoring chart."}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)(d.$,{onClick:H,type:"button",variant:"outline",className:"w-full",disabled:_,children:[_&&(0,t.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}),(0,t.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Save as Draft"]}),(0,t.jsxs)(d.$,{type:"submit",className:"w-full bg-accent hover:bg-accent/90",disabled:V,children:[V&&(0,t.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}),(0,t.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"Submit Review"]})]})]})]})})]}),(0,t.jsx)(S.Lt,{open:T,onOpenChange:Y,children:(0,t.jsxs)(S.EO,{children:[(0,t.jsxs)(S.wd,{children:[(0,t.jsx)(S.r7,{children:"Are you ready to submit this review?"}),(0,t.jsx)(S.$v,{children:"Please review your feedback before submitting. This review will be sent to the artist and cannot be easily modified after submission."})]}),(0,t.jsxs)(S.ck,{children:[(0,t.jsx)(S.Zr,{children:"Cancel"}),(0,t.jsx)(S.Rx,{onClick:()=>{Y(!1),L(!0)},children:"Continue"})]})]})}),(0,t.jsx)(S.Lt,{open:B,onOpenChange:L,children:(0,t.jsxs)(S.EO,{children:[(0,t.jsxs)(S.wd,{children:[(0,t.jsx)(S.r7,{children:"Final confirmation required"}),(0,t.jsxs)(S.$v,{children:["This is your final chance to review your feedback. Once submitted, this review will be permanently published and the artist will be notified immediately.",(0,t.jsxs)("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[(0,t.jsxs)("p",{className:"text-sm",children:[(0,t.jsx)("strong",{children:"Overall Score:"})," ",X.toFixed(1),"/10"]}),(0,t.jsxs)("p",{className:"text-sm",children:[(0,t.jsx)("strong",{children:"Track:"}),' "',null==U?void 0:U.songTitle,'" by ',null==U?void 0:U.artistName]}),q.watch("audioFeedbackUrl")&&(0,t.jsx)("p",{className:"text-sm",children:"âœ“ Audio feedback included"}),q.watch("videoFeedbackUrl")&&(0,t.jsx)("p",{className:"text-sm",children:"âœ“ Video feedback included"})]})]})]}),(0,t.jsxs)(S.ck,{children:[(0,t.jsx)(S.Zr,{children:"Cancel"}),(0,t.jsxs)(S.Rx,{onClick:I,disabled:V,children:[V&&(0,t.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Yes, Submit Review"]})]})]})})]})}},68856:(e,s,a)=>{"use strict";a.d(s,{E:()=>l});var t=a(95155),i=a(59434);function l(e){let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,i.cn)("animate-pulse rounded-md bg-muted",s),...a})}},77260:(e,s,a)=>{Promise.resolve().then(a.bind(a,49762))},90010:(e,s,a)=>{"use strict";a.d(s,{$v:()=>j,EO:()=>m,Lt:()=>n,Rx:()=>p,Zr:()=>b,ck:()=>h,r7:()=>f,tv:()=>c,wd:()=>x});var t=a(95155),i=a(12115),l=a(62278),r=a(59434),d=a(30285);let n=l.bL,c=l.l9,o=l.ZL,u=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(l.hJ,{className:(0,r.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...i,ref:s})});u.displayName=l.hJ.displayName;let m=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsxs)(o,{children:[(0,t.jsx)(u,{}),(0,t.jsx)(l.UC,{ref:s,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...i})]})});m.displayName=l.UC.displayName;let x=e=>{let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...a})};x.displayName="AlertDialogHeader";let h=e=>{let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,r.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a})};h.displayName="AlertDialogFooter";let f=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(l.hE,{ref:s,className:(0,r.cn)("text-lg font-semibold",a),...i})});f.displayName=l.hE.displayName;let j=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(l.VY,{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",a),...i})});j.displayName=l.VY.displayName;let p=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(l.rc,{ref:s,className:(0,r.cn)((0,d.r)(),a),...i})});p.displayName=l.rc.displayName;let b=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(l.ZD,{ref:s,className:(0,r.cn)((0,d.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...i})});b.displayName=l.ZD.displayName}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,3644,4277,555,6874,5594,375,9260,4052,8731,8207,4103,788,2320,5525,9521,8441,1684,7358],()=>s(77260)),_N_E=e.O()}]);