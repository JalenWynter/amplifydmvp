(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3359],{31119:(e,a,t)=>{Promise.resolve().then(t.bind(t,38477))},38477:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>k});var n=t(95155),r=t(66695),s=t(85127),c=t(26126),o=t(30285),i=t(88390),l=t(34301),d=t(50172),u=t(3561),h=t(44838),g=t(41696),x=t(38995),m=t(6874),y=t.n(m),j=t(12115),p=t(68856),f=t(87481);let w=(0,t(55028).default)(()=>Promise.all([t.e(5594),t.e(9260),t.e(4434),t.e(8646)]).then(t.bind(t,68646)),{loadableGenerated:{webpack:()=>[68646]},ssr:!1});function v(){return(0,n.jsxs)(s.Hj,{children:[(0,n.jsx)(s.nA,{children:(0,n.jsx)(p.E,{className:"h-4 w-32"})}),(0,n.jsx)(s.nA,{children:(0,n.jsx)(p.E,{className:"h-4 w-24"})}),(0,n.jsx)(s.nA,{children:(0,n.jsx)(p.E,{className:"h-6 w-20 rounded-full"})}),(0,n.jsx)(s.nA,{children:(0,n.jsx)(p.E,{className:"h-4 w-24"})}),(0,n.jsx)(s.nA,{children:(0,n.jsx)(p.E,{className:"h-8 w-8"})})]})}function N(){return(0,n.jsx)(s.Hj,{children:(0,n.jsx)(s.nA,{colSpan:5,children:(0,n.jsxs)("div",{className:"text-center py-10",children:[(0,n.jsx)(i.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,n.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No Payouts"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"There are no pending or completed payouts to display."})]})})})}function k(){let[e,a]=(0,j.useState)([]),[t,i]=(0,j.useState)([]),[m,p]=(0,j.useState)(!0),[k,E]=(0,j.useState)(!1),[b,A]=(0,j.useState)(!1),[P,F]=(0,j.useState)(null),{toast:C}=(0,f.dj)(),S=async()=>{p(!0);let[e,t]=await Promise.all([(0,g._9)(),(0,x.dQ)()]);a(e),i(t),p(!1)};(0,j.useEffect)(()=>{S()},[]);let R=async e=>{A(!0);try{await (0,g.FB)(e),C({title:"Payout Created",description:"A new pending payout for ".concat(e.reviewer.name," has been created.")}),E(!1),S()}catch(e){console.error("Failed to create payout:",e),C({title:"Error",description:"Failed to create payout.",variant:"destructive"})}finally{A(!1)}},_=async e=>{F(e);try{await (0,g.OC)(e,"Paid"),C({title:"Payout Updated",description:"This payout has been marked as paid."}),S()}catch(e){C({title:"Error",description:"Failed to update payout status.",variant:"destructive"}),console.error("Payout update failed:",e)}finally{F(null)}};return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold font-headline",children:"Payouts"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(y(),{href:"/admin/financials",children:(0,n.jsx)("button",{className:"px-4 py-2 text-sm font-medium rounded-md bg-gray-100 text-gray-700 hover:bg-gray-200",children:"Overview"})}),(0,n.jsx)(y(),{href:"/admin/financials/transactions",children:(0,n.jsx)("button",{className:"px-4 py-2 text-sm font-medium rounded-md bg-gray-100 text-gray-700 hover:bg-gray-200",children:"Transactions"})})]})]}),(0,n.jsxs)(n.Fragment,{children:[k&&(0,n.jsx)(w,{reviewers:t,onSave:R,onCancel:()=>E(!1),isSaving:b}),(0,n.jsxs)(r.Zp,{children:[(0,n.jsxs)(r.aR,{className:"flex flex-row items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(r.ZB,{children:"Reviewer Payouts"}),(0,n.jsx)(r.BT,{children:"Review and process outstanding payments to reviewers."})]}),(0,n.jsxs)(o.$,{onClick:()=>E(!0),children:[(0,n.jsx)(l.A,{className:"mr-2 h-4 w-4"}),"Create Payout"]})]}),(0,n.jsx)(r.Wu,{children:(0,n.jsxs)(s.XI,{children:[(0,n.jsx)(s.A0,{children:(0,n.jsxs)(s.Hj,{children:[(0,n.jsx)(s.nd,{children:"Reviewer"}),(0,n.jsx)(s.nd,{children:"Amount"}),(0,n.jsx)(s.nd,{children:"Status"}),(0,n.jsx)(s.nd,{children:"Request Date"}),(0,n.jsx)(s.nd,{children:(0,n.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,n.jsx)(s.BF,{children:m?Array.from({length:3}).map((e,a)=>(0,n.jsx)(v,{},a)):e.length>0?e.map(e=>(0,n.jsxs)(s.Hj,{children:[(0,n.jsx)(s.nA,{className:"font-medium",children:e.reviewer.name}),(0,n.jsx)(s.nA,{children:e.amount}),(0,n.jsx)(s.nA,{children:(0,n.jsx)(c.Ex,{variant:"secondary",className:(0,c.BU)(e.status),children:e.status})}),(0,n.jsx)(s.nA,{children:new Date(e.date).toLocaleDateString()}),(0,n.jsx)(s.nA,{className:"text-right",children:P===e.id?(0,n.jsx)(d.A,{className:"h-4 w-4 animate-spin"}):(0,n.jsxs)(h.rI,{children:[(0,n.jsx)(h.ty,{asChild:!0,children:(0,n.jsxs)(o.$,{"aria-haspopup":"true",size:"icon",variant:"ghost",children:[(0,n.jsx)(u.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Toggle menu"})]})}),(0,n.jsxs)(h.SQ,{align:"end",children:[(0,n.jsx)(h._2,{asChild:!0,children:(0,n.jsx)(y(),{href:"/admin/financials/payouts/".concat(e.id),children:"View Details"})}),"Pending"===e.status&&(0,n.jsx)(h._2,{onClick:()=>_(e.id),children:"Mark as Paid"})]})]})})]},e.id)):(0,n.jsx)(N,{})})]})})]})]})]})}},38995:(e,a,t)=>{"use strict";t.d(a,{Eb:()=>d,Sy:()=>l,dQ:()=>i,s2:()=>h,y6:()=>u});var n=t(35317),r=t(81427),s=t(28214);let c=null;function o(){console.log("Reviewer cache invalidated."),c=null}async function i(){if(c)return console.log("Returning cached reviewers..."),c;console.log("Fetching reviewers from Firestore...");let e=(await (0,n.GG)((0,n.P)((0,n.rJ)(s.db,"reviewers"),(0,n.My)("name")))).docs.map(e=>({id:e.id,...e.data()}));return c=e,e}async function l(e){console.log("[getReviewerById] Attempting to fetch reviewer with ID: ".concat(e));let a=(0,n.H9)(s.db,"reviewers",e),t=await (0,n.x7)(a);if(!t.exists())return console.log("[getReviewerById] No reviewer document found for ID: ".concat(e)),null;{let e={id:t.id,...t.data()};return console.log("[getReviewerById] Reviewer found:",e),e}}async function d(e,a){let t=(0,r.Uz)(),n=(0,r.Qg)(t,"addPackage");try{let t=await n(a);return o(),console.log("Add package function called for reviewer ".concat(e)),t.data}catch(a){console.error("Error calling addPackage Cloud Function:",a);let e="An unknown error occurred.";throw a instanceof Error?e=a.message:"object"==typeof a&&null!==a&&"message"in a&&(e=a.message),Error("Failed to add package: ".concat(e))}}async function u(e,a){let t=(0,r.Uz)(),n=(0,r.Qg)(t,"updatePackage");try{await n(a),o(),console.log("Update package function called for package ".concat(a.id))}catch(a){console.error("Error calling updatePackage Cloud Function:",a);let e="An unknown error occurred.";throw a instanceof Error?e=a.message:"object"==typeof a&&null!==a&&"message"in a&&(e=a.message),Error("Failed to update package: ".concat(e))}}async function h(e,a){let t=(0,r.Uz)(),n=(0,r.Qg)(t,"deletePackage");try{await n({packageId:a}),o(),console.log("Delete package function called for package ".concat(a))}catch(a){console.error("Error calling deletePackage Cloud Function:",a);let e="An unknown error occurred.";throw a instanceof Error?e=a.message:"object"==typeof a&&null!==a&&"message"in a&&(e=a.message),Error("Failed to delete package: ".concat(e))}}},41696:(e,a,t)=>{"use strict";t.d(a,{FB:()=>i,OC:()=>l,RY:()=>o,_9:()=>c});var n=t(81427),r=t(28214),s=t(35317);async function c(){return console.log("Fetching payouts from Firestore..."),(await (0,s.GG)((0,s.P)((0,s.rJ)(r.db,"payouts"),(0,s.My)("date","desc")))).docs.map(e=>({id:e.id,...e.data()}))}async function o(e){console.log("Fetching payout ".concat(e," from Firestore..."));let a=(0,s.H9)(r.db,"payouts",e),t=await (0,s.x7)(a);return t.exists()?{id:t.id,...t.data()}:null}async function i(e){console.log("Calling createPayout Cloud Function...");let a=(0,r.rm)(),t=(0,n.Qg)(a,"createPayout");try{return(await t(e)).data}catch(a){console.error("Error calling createPayout Cloud Function:",a);let e="An unknown error occurred.";throw a instanceof Error?e=a.message:"object"==typeof a&&null!==a&&"message"in a&&(e=a.message),Error("Failed to create payout: ".concat(e))}}async function l(e,a){console.log("Calling updatePayoutStatus Cloud Function for payout ".concat(e," to status ").concat(a));let t=(0,r.rm)(),s=(0,n.Qg)(t,"updatePayoutStatus");try{return(await s({payoutId:e,status:a})).data}catch(a){console.error("Error calling updatePayoutStatus Cloud Function:",a);let e="An unknown error occurred.";throw a instanceof Error?e=a.message:"object"==typeof a&&null!==a&&"message"in a&&(e=a.message),Error("Failed to update payout status: ".concat(e))}}}},e=>{var a=a=>e(e.s=a);e.O(0,[2992,3644,4277,555,6874,375,6425,4052,3421,2890,99,8441,1684,7358],()=>a(31119)),_N_E=e.O()}]);