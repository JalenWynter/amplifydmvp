"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2320],{4839:(e,t,r)=>{r.d(t,{lo:()=>s,pU:()=>c,v_:()=>i});var n=r(35317),o=r(81427),a=r(28214);async function s(){return console.log("Fetching users from Firestore..."),(await (0,n.GG)((0,n.P)((0,n.rJ)(a.db,"users"),(0,n.My)("joinedAt","desc")))).docs.map(e=>({id:e.id,...e.data()}))}async function i(e,t){let r=(0,o.Uz)(),n=(0,o.Qg)(r,"updateUserRole");try{let r=await n({userId:e,newRole:t});return console.log("User ".concat(e," role updated to ").concat(t)),r.data}catch(t){console.error("Error updating user role:",t);let e="An unknown error occurred.";return t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),{success:!1,error:e}}}async function c(e,t){let r=(0,o.Uz)(),n=(0,o.Qg)(r,"updateUserStatus");try{let r=await n({userId:e,newStatus:t});return console.log("User ".concat(e," status updated to ").concat(t)),r.data}catch(t){console.error("Error updating user status:",t);let e="An unknown error occurred.";return t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),{success:!1,error:e}}}},10486:(e,t,r)=>{r.d(t,{Ij:()=>g,LH:()=>d,RV:()=>u,Y8:()=>c,h6:()=>i,zu:()=>l});var n=r(35317),o=r(28214),a=r(81038),s=r(97326);async function i(e){console.log("Submitting review to Firestore...");try{let t=await (0,s.hx)(e.submissionId);if(!t)throw Error("Submission with ID ".concat(e.submissionId," not found."));let r=(0,n.wP)(o.db),i=(0,n.H9)((0,n.rJ)(o.db,"reviews")),c={...e,createdAt:new Date().toISOString(),submissionDetails:{artistName:t.artistName,songTitle:t.songTitle}};r.set(i,c);let l=(0,n.H9)(o.db,"submissions",e.submissionId);return r.update(l,{status:a.M1.REVIEWED,reviewedAt:new Date().toISOString()}),await r.commit(),{...c,id:i.id}}catch(t){console.error("Error submitting review:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to submit review: ".concat(e))}}async function c(e){console.log("Fetching reviews for reviewer ".concat(e," from Firestore..."));let t=(0,n.rJ)(o.db,"reviews"),r=(0,n.P)(t,(0,n._M)("reviewerId","==",e),(0,n.My)("createdAt","desc"));return(await (0,n.GG)(r)).docs.map(e=>({id:e.id,...e.data()}))}async function l(){console.log("Fetching all reviews from Firestore...");let e=(0,n.rJ)(o.db,"reviews"),t=(0,n.P)(e,(0,n.My)("createdAt","desc"));return(await (0,n.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}async function u(e){console.log("Fetching review ".concat(e," from Firestore..."));let t=(0,n.H9)(o.db,"reviews",e),r=await (0,n.x7)(t);return r.exists()?{id:r.id,...r.data()}:(console.log("No such document!"),null)}async function d(e,t){console.log("Checking if reviewer ".concat(t," has submitted review for submission ").concat(e,"..."));let r=(0,n.rJ)(o.db,"reviews"),a=(0,n.P)(r,(0,n._M)("submissionId","==",e),(0,n._M)("reviewerId","==",t),(0,n.AB)(1));return!(await (0,n.GG)(a)).empty}async function g(e,t){console.log("Submitting review as admin to Firestore...");try{let r=await (0,s.hx)(t);if(!r)throw Error("Submission with ID ".concat(t," not found."));let i=(0,n.wP)(o.db),c=(0,n.H9)((0,n.rJ)(o.db,"reviews")),l={...e,createdAt:new Date().toISOString(),submissionDetails:{artistName:r.artistName,songTitle:r.songTitle}};i.set(c,l);let u=(0,n.H9)(o.db,"submissions",t);return i.update(u,{status:a.M1.REVIEWED,reviewedAt:new Date().toISOString()}),await i.commit(),{...l,id:c.id}}catch(t){console.error("Error submitting review as admin:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to submit review as admin: ".concat(e))}}},20201:(e,t,r)=>{r.d(t,{Bo:()=>u,DU:()=>l,Nq:()=>i,OI:()=>p,Uz:()=>c,ZB:()=>m,t0:()=>d,ul:()=>g});var n=r(35317),o=r(28214),a=r(81427),s=r(81038);async function i(e,t){console.log("Calling createReferralCode Cloud Function for ".concat(e,"..."));let r=(0,o.rm)(),n=(0,a.Qg)(r,"createReferralCode");try{return(await n({associatedUser:e,referrerId:t})).data}catch(t){console.error("Error calling createReferralCode Cloud Function:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to create referral code: ".concat(e))}}async function c(){console.log("Fetching all referral codes from Firestore...");let e=(0,n.rJ)(o.db,"referralCodes"),t=(0,n.P)(e,(0,n.My)("createdAt","desc"));return(await (0,n.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}async function l(){console.log("Fetching all referral codes for admin...");let e=(0,n.rJ)(o.db,"referralCodes"),t=(0,n.P)(e,(0,n.My)("createdAt","desc"));return(await (0,n.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}async function u(e){let t;console.log("Fetching referral earnings".concat(e?" for user ".concat(e):" for all users","..."));let r=(0,n.rJ)(o.db,"referralEarnings");return t="all"!==e&&e?(0,n.P)(r,(0,n._M)("referrerId","==",e),(0,n.My)("createdAt","desc")):(0,n.P)(r,(0,n.My)("createdAt","desc")),(await (0,n.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}async function d(e){console.log("Calculating referral stats for user ".concat(e,"..."));let[t,r]=await Promise.all([c(),u(e)]),n=t.filter(t=>t.associatedUser===e),o=n.filter(e=>e.status===s.Bz.USED).length,a=n.filter(e=>e.status===s.Bz.ACTIVE).length,i=r.reduce((e,t)=>e+t.commissionAmount,0),l=r.filter(e=>"pending"===e.status).reduce((e,t)=>e+t.commissionAmount,0);r.filter(e=>"paid"===e.status).reduce((e,t)=>e+t.commissionAmount,0);let d=n.length>0?o/n.length*100:0;return{totalReferrals:o,activeReferrals:a,totalEarnings:i,pendingEarnings:l,conversionRate:d}}async function g(e){console.log("Checking codes created today for user ".concat(e,"..."));let t=new Date;t.setHours(0,0,0,0);let r=t.toISOString(),a=(0,n.rJ)(o.db,"referralCodes"),s=(0,n.P)(a,(0,n._M)("associatedUser","==",e),(0,n._M)("createdAt",">=",r));return(await (0,n.GG)(s)).size}async function m(e){console.log("Fetching referral history for user ".concat(e,"..."));let[t,r]=await Promise.all([c(),u(e)]);return{referralCodes:t.filter(t=>t.associatedUser===e),referralEarnings:r}}async function p(e){return console.log("Fetching referral tracking chain for user ".concat(e,"...")),{}}},23062:(e,t,r)=>{r.d(t,{Q3:()=>u,_B:()=>a,h4:()=>o,qD:()=>l});var n=r(55594);let o=n.z.object({id:n.z.string(),name:n.z.string(),email:n.z.string().email(),avatarUrl:n.z.string().url().optional(),role:n.z.enum(["uploader","reviewer","admin"]),status:n.z.enum(["active","inactive","pending","suspended"]),joinedAt:n.z.string().datetime(),referredBy:n.z.string().optional(),referredByEmail:n.z.string().email().optional(),referralCode:n.z.string().optional()});n.z.object({id:n.z.string(),userId:n.z.string(),name:n.z.string(),email:n.z.string().email(),status:n.z.enum(["pending","approved","rejected"]),submittedAt:n.z.string().datetime(),portfolioLink:n.z.string().url().optional(),referral:n.z.string().optional(),musicBackground:n.z.string().optional(),joinReason:n.z.string().optional()});let a=n.z.object({applicationMode:n.z.enum(["open","invite-only"])});n.z.object({id:n.z.string(),type:n.z.string(),timestamp:n.z.string().datetime(),userEmail:n.z.string().email().optional(),details:n.z.record(n.z.string(),n.z.unknown()).optional()}),n.z.object({totalUsers:n.z.number(),totalReviewers:n.z.number(),totalSubmissions:n.z.number(),completedReviews:n.z.number()}),n.z.object({totalRevenue:n.z.number(),avgRevenuePerUser:n.z.number(),pendingPayouts:n.z.number(),pendingPayoutsCount:n.z.number(),totalUsers:n.z.number()}),n.z.object({successfulTransactions:n.z.number(),totalTransactions:n.z.number(),conversionRate:n.z.number(),failedTransactions:n.z.number()}),n.z.object({id:n.z.string(),reviewerId:n.z.string(),reviewer:n.z.object({id:n.z.string(),name:n.z.string(),email:n.z.string().email(),avatarUrl:n.z.string().url().optional()}),amount:n.z.number(),amountInCents:n.z.number().int().positive(),status:n.z.enum(["Pending","Paid","Failed"]),date:n.z.string().datetime(),paidDate:n.z.string().datetime().optional(),paymentMethod:n.z.string(),reviews:n.z.array(n.z.object({id:n.z.string(),artist:n.z.string(),song:n.z.string(),fee:n.z.number(),date:n.z.string().datetime()})).default([])}),n.z.object({id:n.z.string(),type:n.z.enum(["submission_payment","payout","referral_earning"]),amount:n.z.number(),currency:n.z.string(),status:n.z.enum(["succeeded","failed","pending","completed","cancelled"]),createdAt:n.z.string().datetime(),updatedAt:n.z.string().datetime(),description:n.z.string().optional(),relatedUserId:n.z.string().optional(),relatedSubmissionId:n.z.string().optional(),stripePaymentIntentId:n.z.string().optional(),stripeCheckoutSessionId:n.z.string().optional(),stripeSessionId:n.z.string().optional(),contactEmail:n.z.string().email().optional(),artistName:n.z.string().optional(),songTitle:n.z.string().optional(),uploaderEmail:n.z.string().email().optional(),reviewerId:n.z.string().optional()});let s=n.z.object({id:n.z.string(),code:n.z.string(),referrerId:n.z.string(),associatedUser:n.z.string(),status:n.z.enum(["Active","Used","Expired"]),createdAt:n.z.string().datetime(),usedAt:n.z.string().datetime().optional(),usedBy:n.z.string().optional(),usedByEmail:n.z.string().email().optional()}),i=n.z.object({id:n.z.string(),referrerId:n.z.string(),referredUserId:n.z.string(),referredUserName:n.z.string(),referredUserEmail:n.z.string().email(),originalAmount:n.z.number(),commissionAmount:n.z.number(),createdAt:n.z.string().datetime(),status:n.z.enum(["pending","paid"])});n.z.object({totalReferrals:n.z.number().default(0),activeReferrals:n.z.number().default(0),totalEarnings:n.z.number().default(0),pendingEarnings:n.z.number().default(0),conversionRate:n.z.number().default(0)}),n.z.object({userInfo:o.optional(),referrer:o.optional(),referralCode:s.optional(),generatedCodes:n.z.array(s).default([]),referredUsers:n.z.array(o).default([]),earningsReceived:n.z.array(i).default([])});let c=o.extend({bio:n.z.string().optional(),genres:n.z.array(n.z.string()).optional(),turnaround:n.z.string().optional(),turnaroundTime:n.z.number().optional(),experience:n.z.string().optional(),reviewRate:n.z.number().optional(),totalEarned:n.z.number().default(0),totalPaid:n.z.number().default(0),portfolioLinks:n.z.array(n.z.string().url()).optional(),manualPaymentInfo:n.z.string().optional(),packages:n.z.array(n.z.object({id:n.z.string(),name:n.z.string(),priceInCents:n.z.number().int().positive(),description:n.z.string(),trackCount:n.z.number().int().positive(),formats:n.z.array(n.z.enum(["written","audio","video","chart"]))})).default([])});n.z.object({id:n.z.string(),name:n.z.string(),priceInCents:n.z.number().int().positive(),description:n.z.string(),trackCount:n.z.number().int().positive(),formats:n.z.array(n.z.enum(["written","audio","video","chart"]))}),n.z.object({id:n.z.string(),submissionId:n.z.string(),reviewerId:n.z.string(),scores:n.z.record(n.z.string(),n.z.number()),overallScore:n.z.number().min(1).max(10),strengths:n.z.string().min(50),improvements:n.z.string().min(50),summary:n.z.string().min(50),createdAt:n.z.string().datetime(),submissionDetails:n.z.object({artistName:n.z.string(),songTitle:n.z.string()})});let l=n.z.object({id:n.z.string(),uploaderId:n.z.string().optional(),uploaderEmail:n.z.string().email(),reviewerId:n.z.string(),packageId:n.z.string(),songUrl:n.z.string().url(),artistName:n.z.string(),songTitle:n.z.string(),genre:n.z.string(),status:n.z.enum(["pending","in-progress","completed","rejected"]),submittedAt:n.z.string().datetime(),reviewedAt:n.z.string().datetime().optional(),paymentIntentId:n.z.string(),trackingToken:n.z.string(),contactEmail:n.z.string().email(),audioUrl:n.z.string().url()}),u=n.z.object({scores:n.z.record(n.z.string(),n.z.coerce.number().min(1).max(10)),overallScore:n.z.coerce.number().min(1).max(10),strengths:n.z.string().min(50,"Strengths must be at least 50 characters."),improvements:n.z.string().min(50,"Improvements must be at least 50 characters."),summary:n.z.string().min(50,"Summary must be at least 50 characters.")});c.pick({name:!0,bio:!0,genres:!0,turnaroundTime:!0,reviewRate:!0,portfolioLinks:!0,manualPaymentInfo:!0})},41696:(e,t,r)=>{r.d(t,{FB:()=>c,OC:()=>l,RY:()=>i,_9:()=>s});var n=r(81427),o=r(28214),a=r(35317);async function s(){return console.log("Fetching payouts from Firestore..."),(await (0,a.GG)((0,a.P)((0,a.rJ)(o.db,"payouts"),(0,a.My)("date","desc")))).docs.map(e=>({id:e.id,...e.data()}))}async function i(e){console.log("Fetching payout ".concat(e," from Firestore..."));let t=(0,a.H9)(o.db,"payouts",e),r=await (0,a.x7)(t);return r.exists()?{id:r.id,...r.data()}:null}async function c(e){console.log("Calling createPayout Cloud Function...");let t=(0,o.rm)(),r=(0,n.Qg)(t,"createPayout");try{return(await r(e)).data}catch(t){console.error("Error calling createPayout Cloud Function:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to create payout: ".concat(e))}}async function l(e,t){console.log("Calling updatePayoutStatus Cloud Function for payout ".concat(e," to status ").concat(t));let r=(0,o.rm)(),a=(0,n.Qg)(r,"updatePayoutStatus");try{return(await a({payoutId:e,status:t})).data}catch(t){console.error("Error calling updatePayoutStatus Cloud Function:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to update payout status: ".concat(e))}}},45011:(e,t,r)=>{r.d(t,{Kg:()=>c,lo:()=>s,pD:()=>i});var n=r(35317),o=r(81427),a=r(28214);async function s(){return console.log("Fetching users from Firestore..."),(await (0,n.GG)((0,n.P)((0,n.rJ)(a.db,"users"),(0,n.My)("joinedAt","desc")))).docs.map(e=>({id:e.id,...e.data()}))}async function i(){if(console.log("[getCurrentUserInfo] Getting current user info..."),!a.j2.currentUser)return console.log("[getCurrentUserInfo] No authenticated user."),null;console.log("[getCurrentUserInfo] Authenticated user UID: ".concat(a.j2.currentUser.uid));let e=(0,n.H9)(a.db,"users",a.j2.currentUser.uid),t=await (0,n.x7)(e);if(!t.exists())return console.log("[getCurrentUserInfo] No user document found for UID: ".concat(a.j2.currentUser.uid)),null;let r={id:t.id,...t.data()};return console.log("[getCurrentUserInfo] User document found:",r),r}async function c(e){console.log("Invoking 'approveApplication' cloud function for application: ".concat(e));try{let t=(0,o.Uz)(),r=(0,o.Qg)(t,"approveApplication"),n=await r({applicationId:e});return console.log("âœ… Application approved successfully.",n.data),n.data}catch(t){console.error("Error calling 'approveApplication' cloud function:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to approve application: ".concat(e))}}},81038:(e,t,r)=>{r.d(t,{nB:()=>s,Bz:()=>o,M1:()=>n,cm:()=>a});let n={PENDING_REVIEW:"Pending Review",IN_PROGRESS:"In Progress",REVIEWED:"Reviewed"},o={ACTIVE:"Active",USED:"Used",EXPIRED:"Expired"},a={PENDING:"pending",COMPLETED:"completed",FAILED:"failed",CANCELLED:"cancelled"},s={INVITE_ONLY:"invite-only",OPEN:"open"};n.PENDING_REVIEW,o.ACTIVE,a.PENDING,s.INVITE_ONLY},82320:(e,t,r)=>{r.d(t,{sI:()=>s,se:()=>m.se,Nq:()=>d.Nq,DU:()=>d.DU,zu:()=>g.zu,tl:()=>G,dR:()=>c,gj:()=>i,ul:()=>d.ul,pD:()=>b.pD,wx:()=>U,jh:()=>C,RY:()=>u.RY,_9:()=>u._9,QX:()=>v,Uz:()=>d.Uz,Bo:()=>d.Bo,t0:()=>d.t0,OI:()=>d.OI,RV:()=>g.RV,Sy:()=>w.Sy,dQ:()=>w.dQ,Y8:()=>g.Y8,hx:()=>m.hx,Oq:()=>m.Oq,C5:()=>m.C5,GC:()=>z,I0:()=>f,ZB:()=>d.ZB,lo:()=>b.lo,LH:()=>g.LH,OQ:()=>l,v1:()=>A,h6:()=>g.h6,uV:()=>D,UO:()=>F,OC:()=>u.OC,qT:()=>m.qT,QM:()=>E});var n=r(35317),o=r(28214),a=r(81427);async function s(e){console.log("Calling submitApplication Cloud Function...");let t=(0,o.rm)(),r=(0,a.Qg)(t,"submitApplication");try{return(await r(e)).data}catch(t){console.error("Error calling submitApplication Cloud Function:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to submit application: ".concat(e))}}async function i(){let e=(0,n.P)((0,n.rJ)(o.db,"applications"),(0,n._M)("status","==","pending"));return(await (0,n.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}async function c(e){let t=(0,n.H9)(o.db,"applications",e),r=await (0,n.x7)(t);return r.exists()?{id:r.id,...r.data()}:null}async function l(e){let t=(0,a.Qg)((0,o.rm)(),"rejectApplication");await t({applicationId:e})}var u=r(41696),d=r(20201),g=r(10486),m=r(97326),p=r(81038);async function f(){console.log("Fetching all transactions from Firestore...");let e=(0,n.rJ)(o.db,"transactions"),t=(0,n.P)(e,(0,n.My)("createdAt","desc"));return(await (0,n.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}async function z(){console.log("Calculating transaction statistics...");let e=await f(),t=e.length,r=e.filter(e=>e.status===p.cm.COMPLETED).length;return{successfulTransactions:r,totalTransactions:t,conversionRate:t>0?r/t*100:0,failedTransactions:e.filter(e=>e.status===p.cm.FAILED).length}}var b=r(45011),w=r(38995),y=r(90858),h=r(51368);async function E(e,t){let r="".concat((0,h.A)(),"-").concat(e.name),n=(0,y.KR)(o.IG,"".concat(t,"/").concat(r));try{let t=await (0,y.D)(n,e),r=await (0,y.qk)(t.ref);return console.log("File uploaded successfully. Download URL:",r),r}catch(e){throw console.error("Error uploading file:",e),Error("Failed to upload file: ".concat(e.message))}}async function v(e){try{let t=(0,n.P)((0,n.rJ)(o.db,"activityEvents"),(0,n.My)("timestamp","desc"),(0,n.AB)(e));return(await (0,n.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error fetching recent activity events:",e),[]}}var I=r(93004);async function A(){console.log("Seeding database..."),(0,I.xI)();let e=(0,a.Uz)();try{let t=(0,a.Qg)(e,"seedDatabaseCallable");await t(),console.log("Database seeding initiated via Cloud Function.")}catch(t){console.error("Error seeding database:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to seed database: ".concat(e))}}async function F(){console.log("Updating database with real UIDs...");let e=(0,a.Uz)();try{let t=(0,a.Qg)(e,"updateDatabaseWithRealUIDsCallable");await t(),console.log("Database update with real UIDs initiated via Cloud Function.")}catch(t){console.error("Error updating database with real UIDs:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to update database with real UIDs: ".concat(e))}}async function U(){console.log("Fetching dashboard stats...");try{let e=await (0,n.GG)((0,n.rJ)(o.db,"users")),t=await (0,n.GG)((0,n.rJ)(o.db,"submissions")),r=await (0,n.GG)((0,n.rJ)(o.db,"reviews")),a=e.size,s=e.docs.filter(e=>"reviewer"===e.data().role).length,i=t.size,c=r.size;return{totalUsers:a,totalReviewers:s,totalSubmissions:i,completedReviews:c}}catch(t){console.error("Error fetching dashboard stats:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to fetch dashboard stats: ".concat(e))}}async function C(){console.log("Fetching financial stats...");try{let e=await (0,n.GG)((0,n.rJ)(o.db,"transactions")),t=await (0,n.GG)((0,n.rJ)(o.db,"payouts")),r=await (0,n.GG)((0,n.rJ)(o.db,"users")),a=e.docs.map(e=>e.data()),s=t.docs.map(e=>e.data()),i=a.reduce((e,t)=>e+("submission_payment"===t.type&&"succeeded"===t.status?t.amount:0),0),c=s.filter(e=>"Pending"===e.status).reduce((e,t)=>e+t.amountInCents,0),l=s.filter(e=>"Pending"===e.status).length,u=r.size;return{totalRevenue:i,avgRevenuePerUser:u>0?i/u:0,pendingPayouts:c,pendingPayoutsCount:l,totalUsers:u}}catch(t){console.error("Error fetching financial stats:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to fetch financial stats: ".concat(e))}}r(4839);var P=r(23062);let j=null;async function G(){if(j)return j;let e=(0,n.H9)(o.db,"settings","app-config"),t=await (0,n.x7)(e);if(t.exists()){let e=P._B.parse(t.data());return j=e,e}{let t={applicationMode:p.nB.INVITE_ONLY};return await (0,n.BN)(e,t),j=t,t}}async function D(e){let t=(0,n.H9)(o.db,"settings","app-config");await (0,n.mZ)(t,e),j=null}},97326:(e,t,r)=>{r.d(t,{C5:()=>u,Ib:()=>s,Oq:()=>i,hx:()=>c,pQ:()=>l,qT:()=>d,se:()=>g});var n=r(81427),o=r(28214),a=r(35317);async function s(e){console.log("Uploading file to Firebase Storage...");try{let t=(0,n.Uz)(),r=(0,n.Qg)(t,"getSignedUploadUrl"),{data:o}=await r({fileName:e.name,contentType:e.type});if(!o||!o.url||!o.filePath)throw Error("Failed to get signed upload URL.");if(!(await fetch(o.url,{method:"PUT",headers:{"Content-Type":e.type,"x-goog-meta-signed-url":"true"},body:e})).ok)throw Error("Failed to upload file using signed URL.");let a="https://firebasestorage.googleapis.com/v0/b/".concat("amplifydmvp.appspot.com","/o/").concat(encodeURIComponent(o.filePath),"?alt=media");return console.log("File uploaded successfully. Download URL:",a),a}catch(t){console.error("Error in uploadMusicFile:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to upload music file: ".concat(e))}}async function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("Fetching submissions from Firestore (all: ".concat(!!e.all,", reviewerId: ").concat(e.reviewerId||"none",", artistId: ").concat(e.artistId||"none",")..."));let t=(0,a.rJ)(o.db,"submissions"),r=(0,a.P)(t,(0,a.My)("submittedAt","desc"));return e.reviewerId?r=(0,a.P)(r,(0,a._M)("reviewerId","==",e.reviewerId)):e.artistId?r=(0,a.P)(r,(0,a._M)("artistId","==",e.artistId)):e.all||(r=(0,a.P)(r,(0,a._M)("status","==","Pending Review"))),(await (0,a.GG)(r)).docs.map(e=>({id:e.id,...e.data()}))}async function c(e){console.log("Fetching submission ".concat(e," from Firestore..."));let t=(0,a.H9)(o.db,"submissions",e),r=await (0,a.x7)(t);return r.exists()?{id:r.id,...r.data()}:(console.log("No such document!"),null)}async function l(e){let t=(0,o.rm)(),r=(0,n.Qg)(t,"getSubmissionStatusByToken");try{return(await r(e)).data}catch(t){console.error("Error calling getSubmissionStatusByToken Cloud Function:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to get submission status: ".concat(e))}}async function u(){console.log("Fetching all submissions for admin from Firestore...");let e=(0,a.rJ)(o.db,"submissions"),t=(0,a.P)(e,(0,a.My)("submittedAt","desc"));return(await (0,a.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}async function d(e,t){console.log("Updating submission ".concat(e," status to ").concat(t));let r=(0,a.H9)(o.db,"submissions",e);try{await (0,a.mZ)(r,{status:t})}catch(t){console.error("Error updating submission status:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to update submission status: ".concat(e))}}async function g(e,t){console.log("Assigning reviewer ".concat(t," to submission ").concat(e));let r=(0,a.H9)(o.db,"submissions",e);try{await (0,a.mZ)(r,{reviewerId:t})}catch(t){console.error("Error assigning reviewer to submission:",t);let e="An unknown error occurred.";throw t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"message"in t&&(e=t.message),Error("Failed to assign reviewer to submission: ".concat(e))}}}}]);